---
import { changeLanguage } from "i18next";
import PageLayout from "@layouts/PageLayout.astro";
import { getCollection, CollectionEntry } from "astro:content";
import i18next, { t, changeLanguage } from "i18next";
import { Trans, HeadHrefLangs } from "astro-i18next/components";

changeLanguage("en");

const currentLang = i18next.language;
export interface Props {
    page: CollectionEntry<"pages">;
}
export async function getStaticPaths() {
    // Fetch all pages that are not hidden and are in the current language directory
    const pages = await getCollection("pages", ({ data }) => !data.hidden);
    // Map over the pages to create the paths
    return pages.map((page) => {
        const slug = page.slug.replace(/index$/, "");
        if (slug === "en") {
            console.log("slug", slug, page);
            return { params: { slug: undefined }, props: { page } };
        }
        return { params: { slug }, props: { page } };
    });
}
const page = Astro.props.page;
if (!page.data.content_blocks) {
    throw new Error(`Tried to output page with unsupported schema: ${page.data._schema}`);
}
---

<PageLayout frontmatter={page.data} />
